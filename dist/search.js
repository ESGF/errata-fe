!function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e,r){"use strict";r.r(e),r.d(e,"COPYRIGHT_YEAR",function(){return n}),r.d(e,"FULLTITLE",function(){return a}),r.d(e,"LONG_NAME",function(){return i}),r.d(e,"NAME",function(){return o}),r.d(e,"ORGANIZATION",function(){return u}),r.d(e,"VERSION",function(){return s}),r.d(e,"events",function(){return c}),r.d(e,"log",function(){return d}),r.d(e,"on",function(){return l}),r.d(e,"trigger",function(){return p});const n=(new Date).getFullYear(),a="ES-DOC Dataset Errata",i="Dataset Errata",o="Errata",u="ES-DOC",s="2.0.0",c=_.extend({},Backbone.Events),d=t=>{console.log(new Date+" :: "+u+"-"+o.toUpperCase()+" :: "+t)},l=(t,e,r)=>{c.on(t,e,r)},p=(t,e)=>(d("event :: "+t),c.trigger(t,e))},function(t,e,r){"use strict";r.r(e),r.d(e,"EMAIL",function(){return B}),r.d(e,"ISSUE",function(){return z}),r.d(e,"MISC",function(){return Y}),r.d(e,"SECURITY",function(){return W}),r.d(e,"URLS",function(){return K});var n={};r.r(n),r.d(n,"CONTACT",function(){return s}),r.d(n,"SUPPORT",function(){return c}),r.d(n,"SUBJECT",function(){return d}),r.d(n,"MESSAGE",function(){return l});var a={};r.r(a),r.d(a,"MODERATION_STATUS_ACCEPTED",function(){return p}),r.d(a,"MODERATION_STATUS_IN_REVIEW",function(){return g}),r.d(a,"MODERATION_STATUS_NOT_REQUIRED",function(){return f}),r.d(a,"MODERATION_STATUS_REJECTED",function(){return h});var i={};r.r(i),r.d(i,"LOGGING_PREFIX",function(){return _}),r.d(i,"NULL_FIELD",function(){return E}),r.d(i,"UI_UPDATE_DELAY",function(){return m});var o={};r.r(o),r.d(o,"USER_ROLE_ANONYMOUS",function(){return A}),r.d(o,"USER_ROLE_AUTHOR",function(){return S}),r.d(o,"USER_ROLE_MODERATOR",function(){return U});var u={};r.r(u),r.d(u,"API_BASE_URL",function(){return I}),r.d(u,"API_PUBLICATION_CREATE",function(){return T}),r.d(u,"API_PUBLICATION_MODERATE",function(){return P}),r.d(u,"API_PUBLICATION_PROPOSE",function(){return R}),r.d(u,"API_PUBLICATION_RETRIEVE",function(){return D}),r.d(u,"API_PUBLICATION_RETRIEVE_ALL",function(){return v}),r.d(u,"API_PUBLICATION_UPDATE",function(){return C}),r.d(u,"API_OAUTH_AUTHORIZE",function(){return O}),r.d(u,"API_PID_RESOLVE",function(){return y}),r.d(u,"API_PID_TASK_QUEUE_SEARCH",function(){return L}),r.d(u,"API_PID_TASK_QUEUE_SEARCH_SETUP",function(){return b}),r.d(u,"API_SEARCH",function(){return w}),r.d(u,"API_SEARCH_MODERATION",function(){return x}),r.d(u,"API_SEARCH_SETUP",function(){return k}),r.d(u,"DOCUMENTATION",function(){return N}),r.d(u,"DOCUMENTATION_PID",function(){return $}),r.d(u,"PAGE_MODERATE",function(){return M}),r.d(u,"PAGE_HOME",function(){return V}),r.d(u,"PAGE_EDIT",function(){return j}),r.d(u,"PAGE_PID",function(){return G}),r.d(u,"PAGE_SEARCH",function(){return F}),r.d(u,"PAGE_VIEW",function(){return H});const s="support@errata.es-doc.org",c="support@errata.es-doc.org",d="ES-DOC ERRATA :: subject goes here",l="Dear ES-DOC ERRATA support team,",p="accepted",g="in-review",f="not-required",h="rejected",_="ES-DOC-ERRATA :: ",E="--",m=1e3,A="anonymous",S="author",U="moderator",I=window.origin,T="/2/publication/create",P="/2/publication/moderate",R="/2/publication/propose",D="/2/publication/retrieve",v="/2/publication/retrieve-all",C="/2/publication/update",O=window.location.origin+"/oauth/authorize",y="/1/resolve/pid",L="/1/pid-queue/search",b="/1/pid-queue/search-setup",w="/2/search/errata",x="/2/search/errata/moderation",k="/2/search/errata/setup",N="https://es-doc.github.io/esdoc-errata-client/",$="https://es-doc.github.io/esdoc-errata-client/lookup.html",M="/static/moderate.html",V="https://es-doc.org",j="/static/edit.html",G="pid.html",F="/static/index.html",H="/static/view.html",B=n,z=a,Y=i,W=o,K=u},function(t,e,r){"use strict";r.r(e),r.d(e,"openURL",function(){return i}),r.d(e,"openDocumentation",function(){return o}),r.d(e,"openPIDDocumentation",function(){return u}),r.d(e,"openHomepage",function(){return s}),r.d(e,"openEmail",function(){return c}),r.d(e,"openSupportEmail",function(){return d}),r.d(e,"render",function(){return l}),r.d(e,"renderHTML",function(){return p}),r.d(e,"renderTemplate",function(){return f}),r.d(e,"getURLParam",function(){return h}),r.d(e,"getPageCount",function(){return E}),r.d(e,"getPages",function(){return m}),r.d(e,"displayFeedback",function(){return A}),r.d(e,"hideFeedback",function(){return S}),r.d(e,"displayInfoDialog",function(){return U}),r.d(e,"hideInfoDialog",function(){return I}),r.d(e,"generateUUID",function(){return T});var n=r(0),a=r(1);const i=(t,e)=>{!0===e?window.open(t):window.location=t},o=()=>{i(a.URLS.DOCUMENTATION,!0)},u=()=>{i(a.URLS.DOCUMENTATION_PID,!0)},s=()=>{i(a.URLS.PAGE_HOME,!0)},c=(t,e,r)=>{var n="mailto:{0}?subject={1}&body={2}";e=e||a.EMAIL.SUBJECT,r=r||a.EMAIL.MESSAGE,n=(n=(n=n.replace("{0}",t)).replace("{1}",e)).replace("{2}",r),window.location.href=n},d=()=>{var t;t=(t=(t="ES-DOC :: SUPPORT :: {0} (v{1})").replace("{0}",n.NAME.toUpperCase())).replace("{1}",n.VERSION),c(a.EMAIL.SUPPORT,t)},l=(t,e,r)=>{var n,a,i=[];return n=_.isArray(t)?t:[t],_.each(n,function(t){a=new t(e).render(),i.push(a),_.isUndefined(r)||(_.has(r,"$el")?r.$el.append(a.$el):r.append(a.$el))},void 0),1===n.length?i[0]:i},p=(t,e,r)=>{var n=e?t(e):t();_.isUndefined(r)||(_.has(r,"$el")?r.$el.append(n):r.append(n))},g={},f=(t,e,r)=>{var a;if(n.log(`template: ${t}`),_.has(g,t)||(g[t]=_.template($("#"+t).html())),a=(0,g[t])(e),r&&r.$el)r.$el.append(a);else{if(!r)return a;r.replaceWith(a)}},h=(t,e)=>{var r=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.href);return r?(r[1]||e).toUpperCase():e},E=function(t,e){var r=0;return e&&e/t>(r=parseInt(e/t,10))&&(r+=1),r},m=(t,e)=>_.map(_.range(E(t,e.length)),function(e){return{id:e+1,data:this.slice(e*t,(e+1)*t-1)}},e),A=t=>{$("#feedbackText").text(t+" ... please wait"),$(".feedback-title").text(n.FULLTITLE),$(".feedback-version").text("v"+n.VERSION),$("#feedbackContainer").modal({backdrop:"static",keyboard:!1,show:!0})},S=()=>{$("#feedbackContainer").modal("hide")},U=(t,e)=>{$("#infoDialogText").text(t),$(".infoDialog-title").text(n.FULLTITLE),$(".infoDialog-version").text("v"+n.VERSION),e&&$("#infoDialogContainer").on("hide.bs.modal",e),$("#infoDialogContainer").modal({backdrop:"static",keyboard:!1,show:!0})},I=()=>{$("#infoDialog").modal("hide")},T=()=>{let t=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)})}},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(1);class a{constructor(){this.oauthCredentials=Cookies.get("errata-oauth-credentials"),this.isAuthenticated=!1===_.isUndefined(this.oauthCredentials),this.isModerator=this.isAuthenticated&&Cookies.get("errata-user-role")===n.SECURITY.USER_ROLE_MODERATOR,this.isAuthor=this.isAuthenticated&&Cookies.get("errata-user-role")===n.SECURITY.USER_ROLE_AUTHOR,this.isAnonymous=!(this.isModerator||this.isAuthor)}}},,function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"user",function(){return g}),r.d(n,"filters",function(){return f}),r.d(n,"paging",function(){return h}),r.d(n,"sorting",function(){return E}),r.d(n,"searchData",function(){return m}),r.d(n,"setSearchData",function(){return A}),r.d(n,"initFilters",function(){return S}),r.d(n,"setActiveFilters",function(){return U}),r.d(n,"getActiveFilters",function(){return I}),r.d(n,"updateFilter",function(){return T}),r.d(n,"paginateIssues",function(){return P}),r.d(n,"sortResults",function(){return R}),r.d(n,"updateSortField",function(){return D});var a=r(0),i=r(2),o=r(1),u=r(3),s=({key:t})=>{const e=c[t];if(e){const r=i.getURLParam(e.urlParam);return r?`${t}:${r.toLowerCase()}`:e.defaultValue||null}return null};const c={"esdoc:errata:project":{urlParam:"project",defaultValue:"esdoc:errata:project:cmip6"},"wcrp:cmip5:experiment":{urlParam:"experiment",defaultValue:null},"wcrp:cmip5:institute":{urlParam:"institute",defaultValue:null},"wcrp:cmip5:model":{urlParam:"model",defaultValue:null},"wcrp:cmip5:variable":{urlParam:"variable",defaultValue:null},"wcrp:cmip6:experiment-id":{urlParam:"experiment",defaultValue:null},"wcrp:cmip6:institution-id":{urlParam:"institute",defaultValue:null},"wcrp:cmip6:source-id":{urlParam:"source",defaultValue:null},"wcrp:cmip6:variable-id":{urlParam:"variable",defaultValue:null},"wcrp:cordex:experiment":{urlParam:"experiment",defaultValue:null},"wcrp:cordex:institute":{urlParam:"institute",defaultValue:null},"wcrp:cordex:rcm-model":{urlParam:"model",defaultValue:null},"wcrp:cordex:variable":{urlParam:"variable",defaultValue:null},"wcrp:input4mips:institution-id":{urlParam:"institute",defaultValue:null},"wcrp:input4mips:source-id":{urlParam:"source",defaultValue:null},"wcrp:input4mips:target-mip":{urlParam:"mip",defaultValue:null},"wcrp:input4mips:variable-id":{urlParam:"variable",defaultValue:null}};class d{constructor(t){this.data={all:_.sortBy(t.terms,t=>t.sortOrdinal||t.key),current:null,set:{}},this.defaultKey=s(t)||null,this.key=t.key,this.label=t.label,this.project=t.key.startsWith("esdoc")?null:t.key.split(":")[1],this.uiPosition="esdoc:errata:project"===t.key?0:"esdoc:errata:severity"===t.key?1e3:"esdoc:errata:status"===t.key?1001:"esdoc:errata:moderationStatus"===t.key?1002:100,"esdoc:errata:project"!==t.key&&this.data.all.unshift({key:this.key+":*",label:"*"}),this.defaultKey&&(this.data.current=_.find(this.data.all,t=>t.key===this.defaultKey)),this.data.current=this.data.current||this.data.all[0],this.data.set=_.indexBy(this.data.all,"key")}}class l{constructor(t,e){this.project=t[0],this.institutionID=t[1],this.uid=t[2],this.title=t[3],this.severity=t[4],this.status=t[5],this.dateCreated=t[6],this.dateClosed=t[7],this.dateUpdated=t[8],this.moderationStatus=t[9],this.ext=new p(this,e)}}class p{constructor(t,e){this.severity=e[2].data.set["esdoc:errata:severity:"+t.severity],this.status=e[3].data.set["esdoc:errata:status:"+t.status],this.institutionID=t.institutionID.toUpperCase(),this.title=(t.title||"--").trim(),t.title.length>53&&(this.title=t.title.slice(0,53)+" ...")}}const g=new u.a;var f=[];const h={current:null,count:0,pages:[],pageSize:25,pageSizeOptions:[25,50,100]},E={field:"dateCreated",direction:"desc"};var m=null;const A=t=>{m=_.defaults({results:_.map(t.results,t=>new l(t,f))},t),R(),P()},S=t=>{f=_.map(t,function(t){return new d(t)}),U()},U=()=>{_.each(f,t=>{t.isActive=_.isNull(t.project)&&"esdoc:errata:moderation-status"!==t.key||t.project===f[1].data.current.key.split(":")[3]})},I=()=>_.filter(f,t=>t.isActive),T=(t,e)=>{var r;(r=_.find(f,e=>e.key===t)).data.current=_.find(r.data.all,t=>t.key===e),"esdoc:errata:project"===r.key&&U(),a.trigger("state:filterUpdated",r)},P=()=>{h.pages=i.getPages(h.pageSize,m.results),h.count=h.pages.length,h.current=h.count>0?h.pages[0]:void 0},R=()=>{var t,e,r;"title"===(e=E.field)?r=t=>t.title:"institutionID"===e?r=t=>t.ext.institutionID:"status"===e?r=t=>t.ext.status.label.toLowerCase():"severity"===e?r=t=>t.ext.severity.sortOrdinal:_.contains(["dateClosed","dateCreated","dateUpdated"],e)&&(r=t=>t[e]?t[e].valueOf():"--"),t=_.sortBy(m.results,r),"desc"===E.direction&&(t=t.reverse()),m.results=t},D=t=>{E.field===t?(E.direction="asc"===E.direction?"desc":"asc",a.trigger("state:sortDirectionToggled")):(a.trigger("state:sortFieldChanging"),E.field=t,_.contains(["dateClosed","dateCreated","dateUpdated","severity"],t)?E.direction="desc":E.direction="asc",a.trigger("state:sortFieldChanged")),R(),P()};var v=Backbone.View.extend({events:{"click img.esdoc-logo":()=>{i.openHomepage()},"click a.esdoc-support":function(t){i.openSupportEmail()},"click a.esdoc-docs":()=>{i.openDocumentation()},"click button.esdoc-errata-login":()=>{i.openURL(o.URLS.API_OAUTH_AUTHORIZE,!1)},"click button.esdoc-errata-create":()=>{i.openURL(o.URLS.PAGE_EDIT,!0)},"click button.esdoc-errata-moderate":()=>{i.openURL(o.URLS.PAGE_MODERATE,!0)},"click button.esdoc-errata-propose":()=>{i.openURL(o.URLS.PAGE_EDIT,!0)},"click button.esdoc-pid-lookup":()=>{i.openURL(o.URLS.PAGE_PID,!0)},"click .issue":t=>{var e;e=o.URLS.PAGE_VIEW,e+="?uid=",e+=$(t.target).parent().attr("id")||$(t.target).parent().parent().attr("id"),i.openURL(e,!0)},"change .filter select":t=>{a.trigger("state:filterUpdate",$(t.target).val())},"change .pagination-info":t=>{var e;e=parseInt($(t.target).val(),10),$(t.target).val(""),!1===_.isNaN(e)&&e>0&&e<=h.pages.length&&h.current!==h.pages[e-1]&&(h.current=h.pages[e-1],a.trigger("state:pageUpdate"))},"click .pagination-first":()=>{h.pages.length&&h.current!==_.first(h.pages)&&(h.current=_.first(h.pages),a.trigger("state:pageUpdate"))},"click .pagination-previous":()=>{h.pages.length&&h.current!==_.first(h.pages)&&(h.current=h.pages[h.current.id-2],a.trigger("state:pageUpdate"))},"click .pagination-next":()=>{h.pages.length&&h.current!==_.last(h.pages)&&(h.current=h.pages[h.current.id],a.trigger("state:pageUpdate"))},"click .pagination-last":()=>{h.pages.length&&h.current!==_.last(h.pages)&&(h.current=_.last(h.pages),a.trigger("state:pageUpdate"))},"change .pagination-page-size":t=>{h.pageSize=$(t.target).val(),h.pages=i.getPages(h.pageSize,m.results),h.count=h.pages.length,h.current=h.count>0?h.pages[0]:void 0,a.trigger("state:pageUpdate")},"click .sort-target":t=>{var e;(e=$(t.target).attr("class"))&&(e=e.split(" "),e=(e=_.find(e,t=>t.startsWith("sort-target-"))).slice(12)),e&&(D(e),a.trigger("state:pageUpdate"))}},initialize:function(){a.on("ui:initialized",this._setSortColumn,this),a.on("search:complete",this._updateStatisticsInfo,this),a.on("state:pageUpdate",this._updateGrid,this),a.on("state:pageUpdate",this._updateGridPager,this),a.on("state:sortFieldChanging",this._clearSortColumn,this),a.on("state:sortFieldChanged",this._setSortColumn,this),a.on("state:sortDirectionToggled",this._toggleSortColumn,this),a.on("project:changed",()=>{this._replaceNode("div.filter","template-filter")},this)},render:function(){return _.each(["template-header","template-filter","template-grid"],t=>{i.renderTemplate(t,null,this)},this),this},_setSortColumn:function(){"asc"===E.direction?this.$(".glyphicon.sort-target-"+E.field).addClass("glyphicon-menu-up"):this.$(".glyphicon.sort-target-"+E.field).addClass("glyphicon-menu-down")},_toggleSortColumn:function(){this._clearSortColumn(),this._setSortColumn()},_clearSortColumn:function(){this.$(".glyphicon.sort-target-"+E.field).removeClass("glyphicon-menu-up"),this.$(".glyphicon.sort-target-"+E.field).removeClass("glyphicon-menu-down")},_updateGrid:function(){this._replaceNode("tbody","template-grid-body")},_updateGridPager:function(){var t;t="Page ",t+=h.current?h.current.id:"0",t+=" of ",t+=h.count,this.$(".pagination-info").attr("placeholder",t),this.$(".pagination-container").removeClass("hidden"),h.count<2&&m.count<25&&this.$(".pagination-container").addClass("hidden")},_updateStatisticsInfo:function(){this._replaceNode("#grid-header-summary","template-grid-header-summary"),this._replaceNode("#grid-footer-summary","template-grid-footer-summary")},_replaceNode:function(t,e){this.$(t).replaceWith(i.renderTemplate(e))}});a.on("setup:begin",()=>{var t;t=o.URLS.API_BASE_URL+o.URLS.API_SEARCH_SETUP,$.get(t).done(t=>{a.trigger("setup:setupDataDownload",t)}).fail(()=>{setTimeout(()=>{a.trigger("setup:setupDataDownload:error")},o.MISC.UI_UPDATE_DELAY)})}),a.on("setup:setupDataDownload",t=>{S(t.vocabs),C(null,"setup:initialSearchDataDownload")}),a.on("state:filterUpdated",t=>{C("search:begin","search:dataDownload"),"esdoc:errata:project"===t.key&&a.trigger("project:changed")}),a.on("state:filterUpdate",t=>{T(t.split(":").slice(0,3).join(":"),t)}),a.on("setup:initialSearchDataDownload",t=>{A(t),a.trigger("setup:complete")}),a.on("search:dataDownload",t=>{A(t),a.trigger("state:pageUpdate"),a.trigger("search:complete")});const C=(t,e)=>{var r,n;!1===_.isNull(t)&&a.trigger(t),r=o.URLS.API_BASE_URL+o.URLS.API_SEARCH,n=[],_.each(_.values(I()),t=>{!1===t.data.current.key.endsWith("*")&&n.push(t.data.current.key)}),n={criteria:n.join(",")},a.trigger(e+"ing"),$.get(r,n).done(t=>{setTimeout(()=>{a.trigger(e,t)},o.MISC.UI_UPDATE_DELAY)}).fail(()=>{setTimeout(()=>{a.trigger(e+":error")},o.MISC.UI_UPDATE_DELAY)})};a.on("setup:begin",()=>{i.displayFeedback("Initializing errata search",a.FULLTITLE,a.VERSION)}),a.on("setup:complete",i.hideFeedback),a.on("setup:setupDataDownload:error",()=>{alert("setup:setupDataDownload:error")}),a.on("search:begin",()=>{i.displayFeedback("Searching errata repository",a.FULLTITLE,a.VERSION)}),a.on("search:complete",i.hideFeedback),a.on("search:dataDownload:error",()=>{alert("search:dataDownload:error")}),$(document).ready(()=>{a.trigger("setup:begin")}),a.events.on("setup:complete",()=>{var t;(t=new v).render(),$("body").append(t.el),a.trigger("ui:initialized")}),window.APP=a,window.STATE=n,window.UTILS=i,window.CONSTANTS=o}]);