!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";n.r(t),n.d(t,"COPYRIGHT_YEAR",function(){return r}),n.d(t,"FULLTITLE",function(){return i}),n.d(t,"LONG_NAME",function(){return o}),n.d(t,"NAME",function(){return a}),n.d(t,"ORGANIZATION",function(){return u}),n.d(t,"VERSION",function(){return c}),n.d(t,"events",function(){return d}),n.d(t,"log",function(){return s}),n.d(t,"on",function(){return l}),n.d(t,"trigger",function(){return f});const r=(new Date).getFullYear(),i="ES-DOC Dataset Errata",o="Dataset Errata",a="Errata",u="ES-DOC",c="2.0.0",d=_.extend({},Backbone.Events),s=e=>{console.log(new Date+" :: "+u+"-"+a.toUpperCase()+" :: "+e)},l=(e,t,n)=>{d.on(e,t,n)},f=(e,t)=>(s("event :: "+e),d.trigger(e,t))},function(e,t,n){"use strict";n.r(t),n.d(t,"EMAIL",function(){return V}),n.d(t,"ISSUE",function(){return Y}),n.d(t,"MISC",function(){return z}),n.d(t,"SECURITY",function(){return W}),n.d(t,"URLS",function(){return q});var r={};n.r(r),n.d(r,"CONTACT",function(){return c}),n.d(r,"SUPPORT",function(){return d}),n.d(r,"SUBJECT",function(){return s}),n.d(r,"MESSAGE",function(){return l});var i={};n.r(i),n.d(i,"MODERATION_STATUS_ACCEPTED",function(){return f}),n.d(i,"MODERATION_STATUS_IN_REVIEW",function(){return p}),n.d(i,"MODERATION_STATUS_NOT_REQUIRED",function(){return E}),n.d(i,"MODERATION_STATUS_REJECTED",function(){return _});var o={};n.r(o),n.d(o,"LOGGING_PREFIX",function(){return A}),n.d(o,"NULL_FIELD",function(){return h}),n.d(o,"UI_UPDATE_DELAY",function(){return I});var a={};n.r(a),n.d(a,"USER_ROLE_ANONYMOUS",function(){return T}),n.d(a,"USER_ROLE_AUTHOR",function(){return g}),n.d(a,"USER_ROLE_MODERATOR",function(){return S});var u={};n.r(u),n.d(u,"API_BASE_URL",function(){return P}),n.d(u,"API_PUBLICATION_CREATE",function(){return D}),n.d(u,"API_PUBLICATION_MODERATE",function(){return O}),n.d(u,"API_PUBLICATION_PROPOSE",function(){return R}),n.d(u,"API_PUBLICATION_RETRIEVE",function(){return U}),n.d(u,"API_PUBLICATION_RETRIEVE_ALL",function(){return m}),n.d(u,"API_PUBLICATION_UPDATE",function(){return w}),n.d(u,"API_OAUTH_AUTHORIZE",function(){return v}),n.d(u,"API_PID_RESOLVE",function(){return x}),n.d(u,"API_PID_TASK_QUEUE_SEARCH",function(){return L}),n.d(u,"API_PID_TASK_QUEUE_SEARCH_SETUP",function(){return b}),n.d(u,"API_SEARCH",function(){return C}),n.d(u,"API_SEARCH_MODERATION",function(){return N}),n.d(u,"API_SEARCH_SETUP",function(){return M}),n.d(u,"DOCUMENTATION",function(){return $}),n.d(u,"DOCUMENTATION_PID",function(){return y}),n.d(u,"PAGE_MODERATE",function(){return k}),n.d(u,"PAGE_HOME",function(){return G}),n.d(u,"PAGE_EDIT",function(){return F}),n.d(u,"PAGE_PID",function(){return H}),n.d(u,"PAGE_SEARCH",function(){return B}),n.d(u,"PAGE_VIEW",function(){return j});const c="support@errata.es-doc.org",d="support@errata.es-doc.org",s="ES-DOC ERRATA :: subject goes here",l="Dear ES-DOC ERRATA support team,",f="accepted",p="in-review",E="not-required",_="rejected",A="ES-DOC-ERRATA :: ",h="--",I=1e3,T="anonymous",g="author",S="moderator",P=window.origin,D="/2/publication/create",O="/2/publication/moderate",R="/2/publication/propose",U="/2/publication/retrieve",m="/2/publication/retrieve-all",w="/2/publication/update",v=window.location.origin+"/oauth/authorize",x="/1/resolve/pid",L="/1/pid-queue/search",b="/1/pid-queue/search-setup",C="/2/search/errata",N="/2/search/errata/moderation",M="/2/search/errata/setup",$="https://es-doc.github.io/esdoc-errata-client/",y="https://es-doc.github.io/esdoc-errata-client/lookup.html",k="/static/moderate.html",G="https://es-doc.org",F="/static/edit.html",H="pid.html",B="/static/index.html",j="/static/view.html",V=r,Y=i,z=o,W=a,q=u},function(e,t,n){"use strict";n.r(t),n.d(t,"openURL",function(){return o}),n.d(t,"openDocumentation",function(){return a}),n.d(t,"openPIDDocumentation",function(){return u}),n.d(t,"openHomepage",function(){return c}),n.d(t,"openEmail",function(){return d}),n.d(t,"openSupportEmail",function(){return s}),n.d(t,"render",function(){return l}),n.d(t,"renderHTML",function(){return f}),n.d(t,"renderTemplate",function(){return E}),n.d(t,"getURLParam",function(){return A}),n.d(t,"getPageCount",function(){return h}),n.d(t,"getPages",function(){return I}),n.d(t,"displayFeedback",function(){return T}),n.d(t,"hideFeedback",function(){return g}),n.d(t,"displayInfoDialog",function(){return S}),n.d(t,"hideInfoDialog",function(){return P}),n.d(t,"generateUUID",function(){return D});var r=n(0),i=n(1);const o=(e,t)=>{!0===t?window.open(e):window.location=e},a=()=>{o(i.URLS.DOCUMENTATION,!0)},u=()=>{o(i.URLS.DOCUMENTATION_PID,!0)},c=()=>{o(i.URLS.PAGE_HOME,!0)},d=(e,t,n)=>{var r="mailto:{0}?subject={1}&body={2}";t=t||i.EMAIL.SUBJECT,n=n||i.EMAIL.MESSAGE,r=(r=(r=r.replace("{0}",e)).replace("{1}",t)).replace("{2}",n),window.location.href=r},s=()=>{var e;e=(e=(e="ES-DOC :: SUPPORT :: {0} (v{1})").replace("{0}",r.NAME.toUpperCase())).replace("{1}",r.VERSION),d(i.EMAIL.SUPPORT,e)},l=(e,t,n)=>{var r,i,o=[];return r=_.isArray(e)?e:[e],_.each(r,function(e){i=new e(t).render(),o.push(i),_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(i.$el):n.append(i.$el))},void 0),1===r.length?o[0]:o},f=(e,t,n)=>{var r=t?e(t):e();_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(r):n.append(r))},p={},E=(e,t,n)=>{var i;if(r.log(`template: ${e}`),_.has(p,e)||(p[e]=_.template($("#"+e).html())),i=(0,p[e])(t),n&&n.$el)n.$el.append(i);else{if(!n)return i;n.replaceWith(i)}},A=(e,t)=>{var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return n?(n[1]||t).toUpperCase():t},h=function(e,t){var n=0;return t&&t/e>(n=parseInt(t/e,10))&&(n+=1),n},I=(e,t)=>_.map(_.range(h(e,t.length)),function(t){return{id:t+1,data:this.slice(t*e,(t+1)*e-1)}},t),T=e=>{$("#feedbackText").text(e+" ... please wait"),$(".feedback-title").text(r.FULLTITLE),$(".feedback-version").text("v"+r.VERSION),$("#feedbackContainer").modal({backdrop:"static",keyboard:!1,show:!0})},g=()=>{$("#feedbackContainer").modal("hide")},S=(e,t)=>{$("#infoDialogText").text(e),$(".infoDialog-title").text(r.FULLTITLE),$(".infoDialog-version").text("v"+r.VERSION),t&&$("#infoDialogContainer").on("hide.bs.modal",t),$("#infoDialogContainer").modal({backdrop:"static",keyboard:!1,show:!0})},P=()=>{$("#infoDialog").modal("hide")},D=()=>{let e=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})}},,,,function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"errata",function(){return d}),n.d(r,"pids",function(){return s}),n.d(r,"setErrata",function(){return l}),n.d(r,"setPIDs",function(){return f});var i=n(0),o=n(2),a=n(1);class u{constructor(e){this.handle=e[0],this.issues=_.map(e[1],e=>new c(e))}}class c{constructor(e){this.artefact=e[1]+"#"+e[2],this.sortOrdinal=e[3],this.uid=e[0],this.is_first=e[4],this.is_latest=e[5],this.unchanged_file=e[6]}}var d=[],s=[];const l=e=>{d=_.map(e,e=>new u(e))},f=e=>{s=e};var p=Backbone.View.extend({events:{"click img.esdoc-logo":()=>{o.openHomepage()},"click a.esdoc-support":function(e){o.openSupportEmail()},"click a.esdoc-docs":()=>{o.openPIDDocumentation()},"change .btn-file :file":e=>{var t,n;t=$("#file-selector")[0].files[0],(n=new FileReader).onload=function(e){e.target.result.trim()&&i.trigger("ui:pidFileSelected",{file:t,pids:e.target.result.trim().split("\n")})},n.readAsText(t)},"change #pid-data":e=>{var t;t=$(e.target).val().trim(),f(t?[t]:[])},"click #searchButton":e=>{s.length&&i.trigger("ui:search")},"click #issueButton":e=>{var t,n;(t=$(e.target).attr("title"))&&(n=window.location.href.replace("pid","view"),n+="?uid=",n+=t,o.openURL(n,!0))}},initialize:function(){i.events.on("ui:pidFileSelected",this._setPIDList,this),i.events.on("search:complete",this._updateGrid,this),this.isFirstGridRender=!0},render:function(){return _.each(["template-header","template-filter"],function(e){o.renderTemplate(e,i,this)},this),this},_replaceNode:function(e,t){this.$(e).replaceWith(o.renderTemplate(t,r))},_setPIDList:function(e){f(e.pids),$("#pid-data").val("file://"+e.file.name)},_updateGrid:function(){this.isFirstGridRender||this.$("table").remove(),o.renderTemplate("template-grid",i,this),this.isFirstGridRender=!1}});window.APP=i,window.STATE=r,window.UTILS=o,window.CONSTANTS=a,i.on("ui:search",()=>{var e,t;i.trigger("search:begin"),e=a.URLS.API_BASE_URL+a.URLS.API_PID_RESOLVE,t={pids:s.join(",")},i.trigger("search:dataDownloading"),$.get(e,t).done(e=>{setTimeout(()=>{i.trigger("search:dataDownload",e)},a.MISC.UI_UPDATE_DELAY)}).fail(e=>{setTimeout(()=>{i.trigger("search:dataDownload:error",e)},a.MISC.UI_UPDATE_DELAY)})}),i.on("search:dataDownload",e=>{l(e.errata),i.trigger("search:complete")}),i.on("setup:begin",()=>{o.displayFeedback("Initializing errata PID Lookup")}),i.on("setup:complete",o.hideFeedback),i.on("setup:setupDataDownload:error",()=>{alert("setup:setupDataDownload:error")}),i.on("search:begin",()=>{o.displayFeedback("Searching PID handle service")}),i.on("search:complete",o.hideFeedback),i.on("search:dataDownload:error",()=>{alert("An error occurred whilst calling the PID handle service")}),$(document).ready(()=>{i.trigger("setup:begin"),i.trigger("setup:complete")}),i.events.on("setup:complete",()=>{var e;(e=new p).render(),$("body").append(e.el),i.log("ui initialized"),i.trigger("ui:initialized")}),window.APP=i,window.STATE=r,window.UTILS=o,window.CONSTANTS=a}]);