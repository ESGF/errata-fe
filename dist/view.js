!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";n.r(e),n.d(e,"COPYRIGHT_YEAR",function(){return r}),n.d(e,"FULLTITLE",function(){return o}),n.d(e,"LONG_NAME",function(){return i}),n.d(e,"NAME",function(){return u}),n.d(e,"ORGANIZATION",function(){return a}),n.d(e,"VERSION",function(){return c}),n.d(e,"events",function(){return s}),n.d(e,"log",function(){return d}),n.d(e,"on",function(){return l}),n.d(e,"trigger",function(){return f});const r=(new Date).getFullYear(),o="ES-DOC Dataset Errata",i="Dataset Errata",u="Errata",a="ES-DOC",c="2.0.0",s=_.extend({},Backbone.Events),d=t=>{console.log(new Date+" :: "+a+"-"+u.toUpperCase()+" :: "+t)},l=(t,e,n)=>{s.on(t,e,n)},f=(t,e)=>(d("event :: "+t),s.trigger(t,e))},function(t,e,n){"use strict";n.r(e),n.d(e,"EMAIL",function(){return F}),n.d(e,"ISSUE",function(){return Y}),n.d(e,"MISC",function(){return W}),n.d(e,"SECURITY",function(){return q}),n.d(e,"URLS",function(){return z});var r={};n.r(r),n.d(r,"CONTACT",function(){return c}),n.d(r,"SUPPORT",function(){return s}),n.d(r,"SUBJECT",function(){return d}),n.d(r,"MESSAGE",function(){return l});var o={};n.r(o),n.d(o,"MODERATION_STATUS_ACCEPTED",function(){return f}),n.d(o,"MODERATION_STATUS_IN_REVIEW",function(){return p}),n.d(o,"MODERATION_STATUS_NOT_REQUIRED",function(){return E}),n.d(o,"MODERATION_STATUS_REJECTED",function(){return _});var i={};n.r(i),n.d(i,"LOGGING_PREFIX",function(){return A}),n.d(i,"NULL_FIELD",function(){return h}),n.d(i,"UI_UPDATE_DELAY",function(){return T});var u={};n.r(u),n.d(u,"USER_ROLE_ANONYMOUS",function(){return I}),n.d(u,"USER_ROLE_AUTHOR",function(){return U}),n.d(u,"USER_ROLE_MODERATOR",function(){return R});var a={};n.r(a),n.d(a,"API_BASE_URL",function(){return D}),n.d(a,"API_PUBLICATION_CREATE",function(){return S}),n.d(a,"API_PUBLICATION_MODERATE",function(){return g}),n.d(a,"API_PUBLICATION_PROPOSE",function(){return O}),n.d(a,"API_PUBLICATION_RETRIEVE",function(){return m}),n.d(a,"API_PUBLICATION_RETRIEVE_ALL",function(){return P}),n.d(a,"API_PUBLICATION_UPDATE",function(){return v}),n.d(a,"API_OAUTH_AUTHORIZE",function(){return L}),n.d(a,"API_PID_RESOLVE",function(){return C}),n.d(a,"API_PID_TASK_QUEUE_SEARCH",function(){return x}),n.d(a,"API_PID_TASK_QUEUE_SEARCH_SETUP",function(){return b}),n.d(a,"API_SEARCH",function(){return w}),n.d(a,"API_SEARCH_MODERATION",function(){return N}),n.d(a,"API_SEARCH_SETUP",function(){return M}),n.d(a,"DOCUMENTATION",function(){return y}),n.d(a,"DOCUMENTATION_PID",function(){return k}),n.d(a,"PAGE_MODERATE",function(){return $}),n.d(a,"PAGE_HOME",function(){return j}),n.d(a,"PAGE_EDIT",function(){return H}),n.d(a,"PAGE_PID",function(){return G}),n.d(a,"PAGE_SEARCH",function(){return V}),n.d(a,"PAGE_VIEW",function(){return B});const c="support@errata.es-doc.org",s="support@errata.es-doc.org",d="ES-DOC ERRATA :: subject goes here",l="Dear ES-DOC ERRATA support team,",f="accepted",p="in-review",E="not-required",_="rejected",A="ES-DOC-ERRATA :: ",h="--",T=1e3,I="anonymous",U="author",R="moderator",D=window.origin,S="/2/publication/create",g="/2/publication/moderate",O="/2/publication/propose",m="/2/publication/retrieve",P="/2/publication/retrieve-all",v="/2/publication/update",L=window.location.origin+"/oauth/authorize",C="/1/resolve/pid",x="/1/pid-queue/search",b="/1/pid-queue/search-setup",w="/2/search/errata",N="/2/search/errata/moderation",M="/2/search/errata/setup",y="https://es-doc.github.io/esdoc-errata-client/",k="https://es-doc.github.io/esdoc-errata-client/lookup.html",$="/static/moderate.html",j="https://es-doc.org",H="/static/edit.html",G="pid.html",V="/static/index.html",B="/static/view.html",F=r,Y=o,W=i,q=u,z=a},function(t,e,n){"use strict";n.r(e),n.d(e,"openURL",function(){return i}),n.d(e,"openDocumentation",function(){return u}),n.d(e,"openPIDDocumentation",function(){return a}),n.d(e,"openHomepage",function(){return c}),n.d(e,"openEmail",function(){return s}),n.d(e,"openSupportEmail",function(){return d}),n.d(e,"render",function(){return l}),n.d(e,"renderHTML",function(){return f}),n.d(e,"renderTemplate",function(){return E}),n.d(e,"getURLParam",function(){return A}),n.d(e,"getPageCount",function(){return h}),n.d(e,"getPages",function(){return T}),n.d(e,"displayFeedback",function(){return I}),n.d(e,"hideFeedback",function(){return U}),n.d(e,"displayInfoDialog",function(){return R}),n.d(e,"hideInfoDialog",function(){return D}),n.d(e,"generateUUID",function(){return S});var r=n(0),o=n(1);const i=(t,e)=>{!0===e?window.open(t):window.location=t},u=()=>{i(o.URLS.DOCUMENTATION,!0)},a=()=>{i(o.URLS.DOCUMENTATION_PID,!0)},c=()=>{i(o.URLS.PAGE_HOME,!0)},s=(t,e,n)=>{var r="mailto:{0}?subject={1}&body={2}";e=e||o.EMAIL.SUBJECT,n=n||o.EMAIL.MESSAGE,r=(r=(r=r.replace("{0}",t)).replace("{1}",e)).replace("{2}",n),window.location.href=r},d=()=>{var t;t=(t=(t="ES-DOC :: SUPPORT :: {0} (v{1})").replace("{0}",r.NAME.toUpperCase())).replace("{1}",r.VERSION),s(o.EMAIL.SUPPORT,t)},l=(t,e,n)=>{var r,o,i=[];return r=_.isArray(t)?t:[t],_.each(r,function(t){o=new t(e).render(),i.push(o),_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(o.$el):n.append(o.$el))},void 0),1===r.length?i[0]:i},f=(t,e,n)=>{var r=e?t(e):t();_.isUndefined(n)||(_.has(n,"$el")?n.$el.append(r):n.append(r))},p={},E=(t,e,n)=>{var o;if(r.log(`template: ${t}`),_.has(p,t)||(p[t]=_.template($("#"+t).html())),o=(0,p[t])(e),n&&n.$el)n.$el.append(o);else{if(!n)return o;n.replaceWith(o)}},A=(t,e)=>{var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.href);return n?(n[1]||e).toUpperCase():e},h=function(t,e){var n=0;return e&&e/t>(n=parseInt(e/t,10))&&(n+=1),n},T=(t,e)=>_.map(_.range(h(t,e.length)),function(e){return{id:e+1,data:this.slice(e*t,(e+1)*t-1)}},e),I=t=>{$("#feedbackText").text(t+" ... please wait"),$(".feedback-title").text(r.FULLTITLE),$(".feedback-version").text("v"+r.VERSION),$("#feedbackContainer").modal({backdrop:"static",keyboard:!1,show:!0})},U=()=>{$("#feedbackContainer").modal("hide")},R=(t,e)=>{$("#infoDialogText").text(t),$(".infoDialog-title").text(r.FULLTITLE),$(".infoDialog-version").text("v"+r.VERSION),e&&$("#infoDialogContainer").on("hide.bs.modal",e),$("#infoDialogContainer").modal({backdrop:"static",keyboard:!1,show:!0})},D=()=>{$("#infoDialog").modal("hide")},S=()=>{let t=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(1);class o{constructor(){this.oauthCredentials=Cookies.get("errata-oauth-credentials"),this.isAuthenticated=!1===_.isUndefined(this.oauthCredentials),this.isModerator=this.isAuthenticated&&Cookies.get("errata-user-role")===r.SECURITY.USER_ROLE_MODERATOR,this.isAuthor=this.isAuthenticated&&Cookies.get("errata-user-role")===r.SECURITY.USER_ROLE_AUTHOR,this.isAnonymous=!(this.isModerator||this.isAuthor)}}},,,,,function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"user",function(){return l}),n.d(r,"issue",function(){return f}),n.d(r,"issueUID",function(){return p}),n.d(r,"datasets",function(){return E}),n.d(r,"facets",function(){return A}),n.d(r,"vocabs",function(){return h}),n.d(r,"projects",function(){return T}),n.d(r,"severity",function(){return I}),n.d(r,"status",function(){return U}),n.d(r,"setVocabs",function(){return R}),n.d(r,"setIssue",function(){return D}),n.d(r,"getVocabCollection",function(){return S}),n.d(r,"getVocabTerm",function(){return g});var o=n(0),i=n(2),u=n(1);class a{constructor(t){_.each(_.keys(t),e=>{this[e]=t[e]}),this.datasets=this.datasets.sort(),this.ext=new c(this)}get fullTitle(){var t;return t=this.project.toUpperCase(),t+=" - ",t+=this.title.slice(0,48),this.title.length>48&&(t+="..."),t}}class c{constructor(t){this.facets=_.map(t.facets,t=>new s(t)),this.institute=t.institute.toUpperCase(),this.project=g("esdoc:errata:project",t.project),this.projectFacets=_.filter(this.project.facets,t=>!1===t.split(":")[2].startsWith("institut")),this.projectDocURL=this.project.isDocumented?"https://documentation.es-doc.org/"+this.project.canonicalName:null,this.severity=g("esdoc:errata:severity",t.severity),this.status=g("esdoc:errata:status",t.status),this.affectedFacets=_.map(this.projectFacets,e=>new d(t.project,this.facets,e))}}class s{constructor(t){this.namespace=t,this.typeof=t.split(":").slice(0,3).join(":"),this.value=t.split(":")[3]}}class d{constructor(t,e,n){this.collection=S(n),this.terms=_.filter(this.collection.terms,t=>_.find(e,e=>t.namespace===e.namespace)),!1===_.isUndefined(this.collection.cimDocumentType)&&_.each(this.terms,e=>{e.documentationURL="https://documentation.es-doc.org/"+t+"/"+this.collection.cimDocumentTypeAlternativeName+"s/"+e.canonicalName})}}const l=new(n(3).a);var f=null;const p=i.getURLParam("uid");var E=[],A=[],h=[],T=[],I=[],U=[];const R=t=>{h=t,T=t[0],I=t[1],U=t[2]},D=t=>{f=new a(t),E=t.datasets,A=t.facets},S=t=>_.find(h,e=>e.key===t),g=(t,e)=>{const n=S(t);if(n)return _.find(n.terms,t=>t.canonicalName===e)};var O=Backbone.View.extend({events:{"click img.esdoc-logo":()=>{i.openHomepage()},"click a.esdoc-support":function(t){i.openSupportEmail()},"click a.esdoc-docs":()=>{i.openDocumentation()},"click button.esdoc-errata-edit":()=>{var t;t=u.URLS.PAGE_EDIT,t+="?uid=",t+=p,i.openURL(t,!1)}},render:function(){return _.each(["template-header","template-issue"],t=>{i.renderTemplate(t,null,this)},this),this}});o.on("setup:begin",()=>{var t;t=u.URLS.API_BASE_URL+u.URLS.API_SEARCH_SETUP,$.get(t).done(t=>{o.trigger("setup:cvDataDownload",t)}).fail(()=>{setTimeout(()=>{o.trigger("setup:cvDataDownload:error")},u.MISC.UI_UPDATE_DELAY)})}),o.on("setup:cvDataDownload",t=>{R(t.vocabs),o.trigger("setup:cvDataParsed")}),o.on("setup:cvDataParsed",()=>{var t,e;t=u.URLS.API_BASE_URL+u.URLS.API_PUBLICATION_RETRIEVE,e={uid:i.getURLParam("uid")},$.get(t,e).done(t=>{setTimeout(()=>{o.trigger("setup:issueDataDownload",t)},u.MISC.UI_UPDATE_DELAY)}).fail(()=>{setTimeout(()=>{o.trigger("setup:issueDataDownload:error")},u.MISC.UI_UPDATE_DELAY)})}),o.on("setup:issueDataDownload",t=>{D(t.issue),o.trigger("setup:complete")}),o.on("setup:begin",()=>{i.displayFeedback("Initializing errata viewer",o.FULLTITLE,o.VERSION)}),o.on("setup:complete",i.hideFeedback),o.on("setup:setupDataDownload:error",()=>{alert("TODO: setup:setupDataDownload:error")}),$(document).ready(()=>{PYESSV.initialise(()=>{o.trigger("setup:begin")})}),o.events.on("setup:complete",()=>{var t;(t=new O).render(),$("body").append(t.el),o.trigger("ui:initialized")}),window.APP=o,window.STATE=r,window.UTILS=i,window.CONSTANTS=u}]);